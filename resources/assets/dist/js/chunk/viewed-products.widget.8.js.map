{"version":3,"sources":["webpack:////Users/mov/Brisum/docker/webserver/www/elastic/www/wp-content/themes/elastic/module/ViewedProducts/Resources/assets/js/viewed-products.widget.js","webpack:////Users/mov/Brisum/docker/webserver/www/elastic/www/wp-content/themes/elastic/module/ViewedProducts/Resources/assets/js/ViewedProducts.js"],"names":["$","Widget","SourceLoader","BundleLoader","RequireInit","ViewedProducts","ViewedProductsWidget","self","productId","parseInt","$element","attr","viewedProducts","viewedProductIds","get","length","loadStylesheets","Theme","url","theme","THEME_VERSION","load","require","ajax","type","data","join","success","response","html","removeClass","add","maxViewedProducts","inArray","productIdIndex","indexOf","filter","value","slice","unshift","cookie","expires","path","split","each","i","val","unique","module","exports"],"mappings":"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","file":"js/chunk/viewed-products.widget.8.js?bfb17038754971dbab55","sourcesContent":["define(\r\n[\r\n    'jquery',\r\n    'lib-widget',\r\n    'lib-source-loader',\r\n    'lib-bundle-loader',\r\n    'lib-require-init',\r\n    './ViewedProducts'\r\n],\r\nfunction(\r\n    $,\r\n    Widget,\r\n    SourceLoader,\r\n    BundleLoader,\r\n    RequireInit,\r\n    ViewedProducts\r\n) {\r\n    class ViewedProductsWidget extends Widget {\r\n        _init () {\r\n            let self= this,\r\n                productId = parseInt(self.$element.attr('data-product')),\r\n                viewedProducts = new ViewedProducts(),\r\n                viewedProductIds = viewedProducts.get();\r\n\r\n            if (viewedProductIds.length) {\r\n                SourceLoader.loadStylesheets([\r\n                    Theme.url.theme + '/resources/assets/dist/slick_style.css?' + Theme.THEME_VERSION,\r\n                ]);\r\n                BundleLoader.load(\r\n                    [\r\n                        require('bundle-loader?&name=slick!slick')\r\n                    ],\r\n                    function () {\r\n                        $.ajax({\r\n                            type: 'get',\r\n                            url: '/?post_type=product&tpl-part=template-parts/product/viewed-products',\r\n                            data: {'post__in': viewedProductIds.join(',')},\r\n                            success: function(response) {\r\n                                self.$element.html(response);\r\n                                self.$element.removeClass('d-none');\r\n\r\n                                new RequireInit(self.$element);\r\n                            }\r\n                        });\r\n                    }\r\n                );\r\n            }\r\n            if (productId) {\r\n                viewedProducts.add(productId);\r\n            }\r\n        };\r\n    }\r\n\r\n    return ViewedProductsWidget;\r\n});\r\n\n\n\n// WEBPACK FOOTER //\n// /Users/mov/Brisum/docker/webserver/www/elastic/www/wp-content/themes/elastic/module/ViewedProducts/Resources/assets/js/viewed-products.widget.js","'use strict';\r\n\r\nclass ViewedProducts {\r\n    constructor() {\r\n        this.maxViewedProducts = 30;\r\n    }\r\n\r\n    add(productId) {\r\n        let self = this,\r\n            viewedProducts = self.get();\r\n\r\n\r\n        if (-1 !== $.inArray(productId, viewedProducts)) {\r\n            var productIdIndex = viewedProducts.indexOf(productId);\r\n            viewedProducts[productIdIndex] = 0;\r\n        }\r\n        viewedProducts = viewedProducts.filter(function (value) {\r\n            return 0 < value;\r\n        });\r\n        viewedProducts = viewedProducts.slice(0, self.maxViewedProducts - 1);\r\n\r\n        viewedProducts.unshift(productId);\r\n        $.cookie('viewed-product', viewedProducts.join(','), {expires: 7, path: '/'});\r\n    }\r\n\r\n    get() {\r\n        let viewedProducts = $.cookie('viewed-product');\r\n\r\n        viewedProducts = viewedProducts ? viewedProducts.split(',') : [];\r\n        $.each(viewedProducts, function (i, val) {\r\n            viewedProducts[i] = parseInt(val);\r\n        });\r\n        viewedProducts = $.unique(viewedProducts);\r\n        viewedProducts = viewedProducts.filter(function (value) {\r\n            return 0 < value;\r\n        });\r\n        viewedProducts = viewedProducts.slice(0, self.maxViewedProducts);\r\n\r\n        return viewedProducts;\r\n    }\r\n}\r\n\r\nmodule.exports = ViewedProducts;\r\n\n\n\n// WEBPACK FOOTER //\n// /Users/mov/Brisum/docker/webserver/www/elastic/www/wp-content/themes/elastic/module/ViewedProducts/Resources/assets/js/ViewedProducts.js"],"sourceRoot":""}